function [ScanInfo] = extractScanInfo(DicomFolder)

sequencefolders = dir(DicomFolder);
sequencefolders(~cellfun('isempty',strfind({sequencefolders.name},'.'))) = [];
sequencefolders(cellfun('isempty',strfind({sequencefolders.name},'t1'))) = [];
seqFolderPath = [DicomFolder '/' sequencefolders(1).name];

dicomfile = dir(seqFolderPath);
dicomfile(cellfun('isempty',strfind({dicomfile.name},'.dcm'))) = [];

metadata = dicominfo([seqFolderPath '/' dicomfile(1).name], 'UseDictionaryVR', true);
date = datenum(metadata.AcquisitionDate,'yyyymmdd');
ScanInfo.Date = datestr(date,'dd mmm yyyy');
ScanInfo.Manufacturer = metadata.Manufacturer;
ScanInfo.ModelName = metadata.ManufacturerModelName;
ScanInfo.FieldStrength = metadata.MagneticFieldStrength;
ScanInfo.InstitutionName = strrep(metadata.InstitutionName,'UCLA','XXXX');
if isfield(metadata,'SoftwareVersions')
    ScanInfo.SoftwareVersions = metadata.SoftwareVersions;
else
    ScanInfo.SoftwareVersions = 'NA';
end

ScanInfo.txt = ...
    [{['\textbf{Institution}: ' ScanInfo.InstitutionName ' \\']} ...
    {['\textbf{Scan Date}: ' ScanInfo.Date ' \\']} ...
    {['\textbf{Scanner}: ' ScanInfo.Manufacturer ' ' ScanInfo.ModelName ' \\']} ...
    {['\textbf{Software Version}: ' ScanInfo.SoftwareVersions ' \\']} ...
    {['\textbf{Field Strength}: ' num2str(ScanInfo.FieldStrength,'%d') 'T']}];
ScanInfo.txt = cellfun(@(x) strrep(x,'_','-'), ScanInfo.txt, 'UniformOutput', false);

% ScanInfo.txt = ...
%     sprintf(['\textbf{Institution}: %s \\'...
%     '\textbf{Scan Date}: %s \\'...
%     '\textbf{Scanner}: %s %s \\'...
%     '\textbf{Software Version}: %s \\'...
%     '\textbf{Field Strength}: %dT \\'],...
%     ScanInfo.InstitutionName, ...
%     ScanInfo.Date, ...
%     ScanInfo.Manufacturer, ...
%     ScanInfo.ModelName, ...
%     ScanInfo.SoftwareVersions, ...
%     ScanInfo.FieldStrength);
% ScanInfo.txt = strrep(ScanInfo.txt,'_','-');

end